

%%%%%%%%%%%%% Axial Bar with a 

%%%%%

K_1 = [1+1*10^7 -1 0;
-1 2 -1;
0 -1 1]
M_1 = [ 1/3+1*10^7 1/6 0;
1/6 2/3 1/6;
0 1/6 1/3]
K_2 = [1 -1 0;
-1 2 -1;
0 -1 1]


K_T_1gg = K_T_1(3,3)
K_T_1gi = K_T_1(3,1:2)
K_T_1ig = K_T_1gi'
K_T_1ii = K_T_1(1:2,1:2)
K_T_1ii(2,2)
K_T_1ii(1,2)
K_T_1ii(2,1)
K_T_2gg = K_T_2(1,1)
K_T_2gi = K_T_2(1,2:3)
K_T_2ig = K_T_2gi'
K_T_2ii = K_T_2(2:3,2:3)
S_1 = K_T_1gg - (K_T_1gi*(K_T_1ii\K_T_1ig))
S_2 = K_T_2gg - (K_T_2gi*(K_T_2ii\K_T_2ig))
S = S_1+S_2
F_T_g = [0];





M_2(2:3,1)
U_tilde_2(1,1)
F_T_2i
F_T_1g = [0]+M_2(1,2:3)*U_tilde_2(2:3,1)+M_2(1,1)*U_tilde_2(1,1)
G_g1 = F_T_1g - (K_T_1gi * (K_T_1ii\F_T_1i))
F_T_2g = [0]+M_2(1,2:3)*U_tilde_2(2:3,1)+M_2(1,1)*U_tilde_2(1,1)
F_T_1g = [0]+M_1(3,1:2)*U_tilde_1(1:2,1)+M_1(3,3)*U_tilde_1(3,1)
G_g1 = F_T_1g - (K_T_1gi * (K_T_1ii\F_T_1i))
G_g2 = F_T_2g - (K_T_2gi * (K_T_2ii\F_T_2i))
Gg = G_g1+G_g2
U_g = S\Gg
U_i1 = K_T_1ii\(F_T_1i - K_T_1ig*1*U_g)
U_i2 = K_T_2ii\(F_T_2i - K_T_2ig*1*U_g)
F_T_g = [0]




U_i1 = K_T_1ii\(F_T_1i - K_T_1ig*1*U_g)
U_i2 = K_T_2ii\(F_T_2i - K_T_2ig*1*U_g)
U = [U_i1;U_g;U_i2]
a_n = U/(0.25*0.1^2)
v_n = a_n*0.5*0.1
U_tilde_1 = (U_1+0.1*v_n1)/(0.25*0.1^2) + ((1-2*0.25)*a_n1)/(2*0.25)
F_T_1i = [0;0]+M_1(1:2,1:2)*U_tilde_1(1:2,1)+M_1(1:2,3)*U_tilde_1(3,1)
F_T_1g = [3.420]+M_1(3,1:2)*U_tilde_1(1:2,1)+M_1(3,3)*U_tilde_1(3,1)
F_T_1g = [0]+M_1(3,1:2)*U_tilde_1(1:2,1)+M_1(3,3)*U_tilde_1(3,1)
U_tilde_2 = (U_2+0.1*v_n2)/(0.25*0.1^2) + ((1-2*0.25)*a_n2)/(2*0.25)
F_T_1i = [0;0]+M_1(1:2,1:2)*U_tilde_1(1:2,1)+M_1(1:2,3)*U_tilde_1(3,1)
F_T_2i = [0;0]+M_2(2:3,2:3)*U_tilde_2(1:2,1)+M_2(2:3,1)*U_tilde_2(3,1)
F_T_2i = [0;3.420]+M_2(2:3,2:3)*U_tilde_2(1:2,1)+M_2(2:3,1)*U_tilde_2(3,1)
F_T_2g = [0]+M_2(1,2:3)*U_tilde_2(2:3,1)+M_2(1,1)*U_tilde_2(1,1)
F_T_g = [0]

